//
//  RMGroupNode.m
//  Redmadrobot
//
//  Created by Dmitry Shashlov on 11/19/14.
//  Copyright (c) 2014 Dmitry Shashlov. All rights reserved.
//

#import "RMGroupNode.h"
#import "RMCollageScene.h"

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////

@interface RMGroupNode()
@property (nonatomic, readwrite) RMCollageGroup *group;
@end

@implementation RMGroupNode

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#pragma mark - Init

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
+ (RMGroupNode *)nodeWithGroup:(RMCollageGroup *)group
{
  CGRect rect = CGRectZero;
  for (RMCollageSector *sector in group.sectors) {
    NSIndexPath *indexPath = sector.indexPath;
    CGRect desiredRect = [[RMCollageScene class] rectForIndexPath:indexPath
                                                  withCollageSize:sector.collage.size.intValue];
    if (rect.origin.x == 0 && rect.origin.y == 0 && rect.size.width == 0 && rect.size.height == 0)
      rect = desiredRect;
    else
      rect = CGRectUnion(rect, desiredRect);
  }
  
  RMGroupNode *node = [RMGroupNode shapeNodeWithRect:rect];
  node.group = group;
  return node;
}

@end
